apiVersion: apps/v1
kind: Deployment
metadata:
  name: craftique-backend
  namespace: default
spec:
  replicas: 2
  selector:
    matchLabels:
      app: craftique-backend
  template:
    metadata:
      labels:
        app: craftique-backend
    spec:
      # VIOLATION : Pod Security (hostNetwork & hostPID)
      # Allows the pod to see all host processes and network traffic.
      hostNetwork: true
      hostPID: true

      containers:
      - name: craftique-backend
        image: craftique-backend:latest
        ports:
        - containerPort: 8000
        
        # VIOLATION : Missing Resource Limits
        # (The 'resources' block from your current file is removed below)

        securityContext:
          # VIOLATION : Privilege Escalation
          privileged: true
          runAsUser: 0  # Runs as ROOT (Breaking your current 1001 setting)
          
          # VIOLATION 5: Unnecessary Capabilities
          capabilities:
            add:
              - "SYS_ADMIN" # Gives the container "God-mode" over the kernel

        env:
          - name: PORT
            value: "8000"
          - name: DATABASE_URL
            value: "postgresql://craftique:craftique_temp_password@postgres-service:5432/craftique"
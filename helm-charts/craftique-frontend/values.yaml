# Craftique Frontend Helm Chart - Default Values
# Security-hardened Next.js configuration

## Application Configuration
nameOverride: ""
fullnameOverride: ""

## Image Configuration
image:
  repository: us-central1-docker.pkg.dev/craftique-project/craftique/frontend
  tag: "@sha256:PLACEHOLDER_UPDATED_BY_CICD"
  pullPolicy: IfNotPresent
  pullSecrets: []

## Replica Configuration
replicaCount: 2

## Update Strategy
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

## Security Context (Pod-level)
podSecurityContext:
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

## Security Context (Container-level)
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  capabilities:
    drop:
      - ALL

## Service Configuration
service:
  type: ClusterIP
  port: 3000
  targetPort: 3000
  annotations: {}

## Resource Limits
resources:
  requests:
    memory: "128Mi"
    cpu: "100m"
  limits:
    memory: "256Mi"
    cpu: "300m"

## Autoscaling
autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

## Health Checks
livenessProbe:
  httpGet:
    path: /
    port: 3000
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /
    port: 3000
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

## Environment Variables
env:
  NEXT_PUBLIC_API_BASE_URL: "https://craftique.chickenkiller.com/api/v1"

## Volume Mounts (for read-only root filesystem)
volumes:
  tmp:
    enabled: true
  nextjsCache:
    enabled: true
    path: /app/.next/cache

## Labels
labels:
  app.kubernetes.io/name: craftique
  app.kubernetes.io/component: frontend
  app.kubernetes.io/part-of: craftique-ecommerce
  app.kubernetes.io/managed-by: helm

## Governance Labels
governanceLabels:
  craftique.io/owner: platform-team
  craftique.io/environment: production
  craftique.io/cost-center: eng-frontend
  craftique.io/criticality: critical
  craftique.io/data-classification: public
  craftique.io/backup-policy: never
  craftique.io/monitoring: enabled
  craftique.io/public-facing: "true"

## Annotations
annotations:
  supply-chain.craftique.io/signed: "true"
  supply-chain.craftique.io/signing-method: "cosign-keyless"
  supply-chain.craftique.io/provenance: "slsa-github-actions"
  craftique.io/description: "Frontend Next.js web application"

## Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

## Network Policy
networkPolicy:
  enabled: true
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow from ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              name: ingress-nginx
      ports:
        - protocol: TCP
          port: 3000
  egress:
    # Allow DNS
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
      ports:
        - protocol: UDP
          port: 53
    # Allow backend API
    - to:
        - podSelector:
            matchLabels:
              app: craftique-backend
      ports:
        - protocol: TCP
          port: 8000
    # Allow HTTPS to external services (Auth0)
    - to:
        - namespaceSelector: {}
      ports:
        - protocol: TCP
          port: 443

## Service Account
serviceAccount:
  create: true
  annotations: {}
  name: ""

## Node Selector
nodeSelector: {}

## Tolerations
tolerations: []

## Affinity
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - craftique
              - key: app.kubernetes.io/component
                operator: In
                values:
                  - frontend
          topologyKey: kubernetes.io/hostname

## Monitoring
monitoring:
  enabled: true
  serviceMonitor:
    enabled: false
    interval: 30s
    path: /metrics
